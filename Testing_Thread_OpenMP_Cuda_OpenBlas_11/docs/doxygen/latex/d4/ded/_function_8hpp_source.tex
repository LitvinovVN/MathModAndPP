\doxysection{Function.\+hpp}
\hypertarget{_function_8hpp_source}{}\label{_function_8hpp_source}\index{HCSLib/Functions/Function.hpp@{HCSLib/Functions/Function.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <iostream>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../CommonHelpers/PrintParams.hpp"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}FunctionDataType.hpp"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}FunctionDataTypes.hpp"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}../Algorithms/AlgorithmImplementationExecParams.hpp"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ "{}../AlgTestingResults/AlgTestingResult.hpp"{}}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{class\ }Function}
\DoxyCodeLine{00013\ \{}
\DoxyCodeLine{00014\ \ \ \ \ \textcolor{comment}{//\ Указатель\ на\ функцию,\ реализующую\ алгоритм}}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keywordtype}{void}*\ func\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{comment}{//\ Тип\ возвращаемого\ значения}}
\DoxyCodeLine{00017\ \ \ \ \ FunctionDataType\ returnType;}
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{comment}{//\ Список\ типов\ аргументов\ функции}}
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{class_function_data_types}{FunctionDataTypes}}\ argumentsTypes;}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00022\ \ \ \ \ Function()}
\DoxyCodeLine{00023\ \ \ \ \ \{\}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00026\ \ \ \ \ Function(T(*function)(T*,\ \textcolor{keywordtype}{size\_t},\ \textcolor{keywordtype}{size\_t}))}
\DoxyCodeLine{00027\ \ \ \ \ \{}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ func\ =\ (\textcolor{keywordtype}{void}*)function;\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\textcolor{keyword}{typeid}(T)\ ==\ \textcolor{keyword}{typeid}(\textcolor{keywordtype}{float}))}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ returnType\ =\ FunctionDataType::fdt\_float;}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \ \ \ \ argumentsTypes.Add(FunctionDataType::fdt\_ptr\_float);}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\textcolor{keyword}{typeid}(T)\ ==\ \textcolor{keyword}{typeid}(\textcolor{keywordtype}{double}))}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ returnType\ =\ FunctionDataType::fdt\_double;}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ argumentsTypes.Add(FunctionDataType::fdt\_ptr\_double);}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Function\ argument\ type\ not\ realized"{}});}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ argumentsTypes.Add(FunctionDataType::fdt\_ull);}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ argumentsTypes.Add(FunctionDataType::fdt\_ull);}
\DoxyCodeLine{00047\ \ \ \ \ \}}
\DoxyCodeLine{00048\ \ \ \ \ }
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \mbox{\hyperlink{class_function_a6b33d12da33ee48d9079a731a220dde2}{GetArgumentsTypesCount}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00052\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ argumentsTypes.Count();}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_function_a4c9eabc18d8bee233962376851e175c6}{CheckArgumentsTypes}}(\mbox{\hyperlink{class_function_data_types}{FunctionDataTypes}}\ argsTypes)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00059\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{class_function_a6b33d12da33ee48d9079a731a220dde2}{GetArgumentsTypesCount}}()\ !=\ argsTypes.Count())}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ i\{0\};\ i\ <\ \mbox{\hyperlink{class_function_a6b33d12da33ee48d9079a731a220dde2}{GetArgumentsTypesCount}}();\ i++)}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(argumentsTypes[i]\ !=\ argsTypes[i])}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00070\ \ \ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \mbox{\hyperlink{struct_alg_testing_result}{AlgTestingResult}}\ Exec(\mbox{\hyperlink{struct_algorithm_implementation_exec_params}{AlgorithmImplementationExecParams}}\ params)}
\DoxyCodeLine{00073\ \ \ \ \ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_function_arguments}{FunctionArguments}}\ functionArguments\ =\ params.functionArguments;}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(argumentsTypes.Count()==3)}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(argumentsTypes[0]\ ==\ FunctionDataType::fdt\_ptr\_float}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ argumentsTypes[1]\ ==\ FunctionDataType::fdt\_ull}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&\&\ argumentsTypes[2]\ ==\ FunctionDataType::fdt\_ull)}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Преобразовываем\ указатель\ func\ к\ нужному\ виду}}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ float*\ (*func\_ptr)(size\_t,\ size\_t);}}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ func\_ptr\ =\ (float\ (*)(\textcolor{keywordtype}{float}*,\ size\_t,\ size\_t))func;}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}*\ arg0\ =\ functionArguments.GetArgumentValue<\textcolor{keywordtype}{float}*>(0);}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}arg0\ =\ "{}}\ <<\ arg0\ <<\ std::endl;}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ arg1\ =\ functionArguments.GetArgumentValue<\textcolor{keywordtype}{size\_t}>(1);}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}arg1\ =\ "{}}\ <<\ arg1\ <<\ std::endl;}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{size\_t}\ arg2\ =\ functionArguments.GetArgumentValue<\textcolor{keywordtype}{size\_t}>(2);}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}arg2\ =\ "{}}\ <<\ arg2\ <<\ std::endl;}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::vector<FuncResult<float>>\ results;}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{unsigned}\ i\{0\};\ i\ <\ params.iterNumber;\ i++)}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ calcStatus\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ start\ =\ high\_resolution\_clock::now();}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ result\_f\ =\ func\_ptr(arg0,\ arg1,\ arg2);\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ stop\ =\ high\_resolution\_clock::now();}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}!!!\ result\_f\ =\ "{}}\ <<\ result\_f\ <<\ std::endl;}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ duration\ =\ duration\_cast<microseconds>(stop\ -\/\ start);\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ t\ =\ duration.count();}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ FuncResult<float>\ funcResF(calcStatus,\ result\_f,\ t);}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ results.push\_back(funcResF);}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ CalculationStatistics\ stats\{results\};}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AlgTestingResult\ algTestingResult;}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algTestingResult.calculationStatistics\ =\ stats;}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ algTestingResult.Print();}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ algTestingResult;}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nNot\ realized!\(\backslash\)n"{}};}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Error!\ Function::Exec(...)\ argumentsTypes.Count()==3\ types\ combination\ not\ realized!"{}});}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\(\backslash\)nNot\ realized!\(\backslash\)n"{}};}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Error!\ Function::Exec(...)\ argumentsTypes.Count()\ not\ realized!"{}});}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \textcolor{comment}{//FuncResult<float>\ res;}}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \textcolor{comment}{//return\ res;}}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordtype}{void}\ Print(PrintParams\ pp)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00131\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ std::cout\ <<\ pp.startMes;}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}func"{}}\ <<\ pp.splitterKeyValue\ <<\ func;}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ std::cout\ <<\ pp.splitter;}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}returnType"{}}\ <<\ pp.splitterKeyValue\ <<\ returnType;}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ std::cout\ <<\ pp.splitter;}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ std::cout\ <<\ \textcolor{stringliteral}{"{}argumentsTypes"{}}\ <<\ pp.splitterKeyValue\ <<\ argumentsTypes;}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ std::cout\ <<\ pp.endMes;}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(pp.isEndl)}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ std::cout\ <<\ std::endl;}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ \};}

\end{DoxyCode}
